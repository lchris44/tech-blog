!function(){"use strict";var b,d,i=tinymce.util.Tools.resolve("tinymce.PluginManager"),o=tinymce.util.Tools.resolve("tinymce.util.VK"),p=function(a){var b=typeof a;return null===a?"null":"object"===b&&(Array.prototype.isPrototypeOf(a)||a.constructor&&"Array"===a.constructor.name)?"array":"object"===b&&(String.prototype.isPrototypeOf(a)||a.constructor&&"String"===a.constructor.name)?"string":b},e=function(a){return function(b){return p(b)===a}},f=function(a){return function(b){return typeof b===a}},q=e("string"),r=e("array"),s=f("boolean"),t=f("function"),j=function(){},a=function(a){return function(){return a}},g=a(!1),h=a(!0),c=function(){return u},u=(b=function(a){return a()},{fold:function(a,b){return a()},isSome:g,isNone:h,getOr:d=function(a){return a},getOrThunk:b,getOrDie:function(a){throw new Error(a||"error: getOrDie called on none.")},getOrNull:a(null),getOrUndefined:a(void 0),or:d,orThunk:b,map:c,each:j,bind:c,exists:g,forall:h,filter:function(){return c()},toArray:function(){return[]},toString:a("none()")}),k=function(e){var b=a(e),d=function(){return f},c=function(a){return a(e)},f={fold:function(b,a){return a(e)},isSome:h,isNone:g,getOr:b,getOrThunk:b,getOrDie:b,getOrNull:b,getOrUndefined:b,or:d,orThunk:d,map:function(a){return k(a(e))},each:function(a){a(e)},bind:c,exists:c,forall:c,filter:function(a){return a(e)?f:u},toArray:function(){return[e]},toString:function(){return"some("+e+")"}};return f},v={some:k,none:c,from:function(a){return null==a?u:k(a)}},w=Array.prototype.indexOf,x=Array.prototype.push,y=function(c,d){var a,b;return a=c,b=d,w.call(a,b)> -1},z=function(b,e){for(var c=b.length,d=new Array(c),a=0;a<c;a++){var f=b[a];d[a]=e(f,a)}return d},A=function(b,c){for(var a=0,d=b.length;a<d;a++)c(b[a],a)},B=function(b){for(var c=[],a=0,d=b.length;a<d;++a){if(!r(b[a]))throw new Error("Arr.flatten item "+a+" was not an array, input: "+b);x.apply(c,b[a])}return c},C=function(b,d){for(var a=0;a<b.length;a++){var c=d(b[a],a);if(c.isSome())return c}return v.none()},D=function(b,c,a){return void 0===a&&(a=function(a,b){return a===b}),b.exists(function(b){return a(b,c)})},E=function(b){for(var c=[],a=0;a<b.length;a++)b[a].each(function(a){c.push(a)});return c},F=function(a,b){return a?v.some(b):v.none()},G=function(b){var a=b.getParam("link_assume_external_targets",!1);return s(a)&&a?1:q(a)&&("http"===a||"https"===a)?a:0},H=function(a){return a.getParam("default_link_target")},I=function(a){return a.getParam("target_list",!0)},J=function(a){return a.getParam("rel_list",[],"array")},K=function(a){return a.getParam("allow_unsafe_link_target",!1,"boolean")},L=tinymce.util.Tools.resolve("tinymce.util.Tools"),l=function(a){return q(a.value)?a.value:""},M=function(a,c){var b=[];return L.each(a,function(a){var d,e=q((d=a).text)?d.text:q(d.title)?d.title:"";if(void 0!==a.menu){var f=M(a.menu,c);b.push({text:e,items:f})}else{var g=c(a);b.push({text:e,value:g})}}),b},m=function(a){return void 0===a&&(a=l),function(b){return v.from(b).map(function(b){return M(b,a)})}},N={sanitize:function(a){return m(l)(a)},sanitizeWith:m,createUi:function(a,b){return function(c){return{name:a,type:"listbox",label:b,items:c}}},getValue:l},O=function(){return(O=Object.assign||function(d){for(var a,b=1,e=arguments.length;b<e;b++)for(var c in a=arguments[b])Object.prototype.hasOwnProperty.call(a,c)&&(d[c]=a[c]);return d}).apply(this,arguments)},P=Object.keys,Q=Object.hasOwnProperty,R=function(b,e){for(var c=P(b),a=0,f=c.length;a<f;a++){var d=c[a];e(b[d],d)}},S=function(c,d){var e,a,f,g,h,b={};return a=c,f=d,g=(e=b,function(a,b){e[b]=a}),h=j,R(a,function(a,b){(f(a,b)?g:h)(a,b)}),b},T=function(a,b){return Q.call(a,b)},U=tinymce.util.Tools.resolve("tinymce.dom.TreeWalker"),V=tinymce.util.Tools.resolve("tinymce.util.URI"),W=function(a){return a&&"a"===a.nodeName.toLowerCase()},X=function(a){return W(a)&&!!$(a)},Y=function(c,e){if(c.collapsed)return[];var a=c.cloneContents(),f=new U(a.firstChild,a),d=[],b=a.firstChild;do e(b)&&d.push(b);while(b=f.next())return d},Z=function(a){return/^\w+:/i.test(a)},$=function(a){return a.getAttribute("data-mce-href")||a.getAttribute("href")},aa=function(b,h){var a,c,d=["noopener"],e=b?b.split(/\s+/):[],f=function(a){return a.filter(function(a){return -1===L.inArray(d,a)})},g=h?(a=f(a=e)).length>0?a.concat(d):d:f(e);return g.length>0?(c=g,L.trim(c.sort().join(" "))):""},ab=function(b,a){return af(a=a||b.selection.getNode())?b.dom.select("a[href]",a)[0]:b.dom.getParent(a,"a[href]")},ac=function(b,a){var c;return(a?a.innerText||a.textContent:b.getContent({format:"text"})).replace(/\uFEFF/g,"")},ad=function(a){return L.grep(a,X).length>0},ae=function(a){var b=a.schema.getTextInlineElements();return 0===Y(a.selection.getRng(),function(a){return 1===a.nodeType&&!W(a)&&!T(b,a.nodeName.toLowerCase())}).length},af=function(a){return a&&"FIGURE"===a.nodeName&&/\bimage\b/i.test(a.className)},ag=function(b,e){var c,d,a=O({},e);if(!(J(b).length>0)&& !1===K(b)){var f=aa(a.rel,"_blank"===a.target);a.rel=f||null}return v.from(a.target).isNone()&& !1===I(b)&&(a.target=H(b)),a.href=(c=a.href,"http"!==(d=G(b))&&"https"!==d||Z(c)?c:d+"://"+c),a},ah=function(a,b,c,d){c.each(function(a){T(b,"innerText")?b.innerText=a:b.textContent=a}),a.dom.setAttribs(b,d),a.selection.select(b)},ai=function(c,b,d,a){a.href&&a.href.toString().includes("#")&&(a.class="scroll-link"),af(b)?ar(c,b,a):d.fold(function(){c.execCommand("mceInsertLink",!1,a)},function(b){c.insertContent(c.dom.createHTML("a",a,c.dom.encode(b)))})},aj=function(a,e,b){var c,d=a.selection.getNode(),f=ab(a,d),g=ag(a,function(a,c,b){return A(a,function(a,d){b=c(b,a,d)}),b}(["title","rel","class","target"],function(a,b){return c[b].each(function(c){a[b]=c.length>0?c:null}),a},{href:(c=b).href}));a.undoManager.transact(function(){b.href===e.href&&e.attach(),f?(a.focus(),ah(a,f,b.text,g)):ai(a,d,b.text,g)})},ak=function(a){var d=a.dom,c=a.selection,g=c.getBookmark(),b=c.getRng().cloneRange(),e=d.getParent(b.startContainer,"a[href]",a.getBody()),f=d.getParent(b.endContainer,"a[href]",a.getBody());e&&b.setStartBefore(e),f&&b.setEndAfter(f),c.setRng(b),a.execCommand("unlink"),c.moveToBookmark(g)},al=function(a){a.undoManager.transact(function(){var b=a.selection.getNode();af(b)?aq(a,b):ak(a),a.focus()})},am=function(a){var b=a.class,c=a.href,d=a.rel,e=a.target,f=a.text,g=a.title;return S({class:b.getOrNull(),href:c,rel:d.getOrNull(),target:e.getOrNull(),text:f.getOrNull(),title:g.getOrNull()},function(b,c){var a;return!1==(a=b,null===a)})},an=function(c,a){var b=a.href;return O(O({},a),{href:V.isDomSafe(b,"a",c.settings)?b:""})},ao=function(a,c,d){var b=an(a,d);a.hasPlugin("rtc",!0)?a.execCommand("createlink",!1,am(b)):aj(a,c,b)},ap=function(a){a.hasPlugin("rtc",!0)?a.execCommand("unlink"):al(a)},aq=function(b,d){var c=b.dom.select("img",d)[0];if(c){var a=b.dom.getParents(c,"a[href]",d)[0];a&&(a.parentNode.insertBefore(c,a),b.dom.remove(a))}},ar=function(b,d,e){var a=b.dom.select("img",d)[0];if(a){var c=b.dom.create("a",e);a.parentNode.insertBefore(c,a),c.appendChild(a)}},as=function(c){var b,a;return a="items",T(b=c,a)&& void 0!==b[a]&&null!==b[a]},at=function(b,a){return C(a,function(a){return as(a)?at(b,a.items):F(a.value===b,a)})},n=function(b,c,d,e){var a=e[c],f=b.length>0;return void 0!==a?at(a,d).map(function(a){return{url:{value:a.value,meta:{text:f?b:a.text,attach:j}},text:f?b:a.text}}):v.none()},au={init:function(a,b){var c={text:a.text,title:a.title},d=function(d){var a,b,e=(a=d.url,F(c.text.length<=0,v.from(a.meta?a.meta.text:null).getOr(a.value))),f=(b=d.url,F(c.title.length<=0,v.from(b.meta?b.met.title:null).getOr("")));return e.isSome()||f.isSome()?v.some(O(O({},e.map(function(a){return{text:a}}).getOr({})),f.map(function(a){return{title:a}}).getOr({}))):v.none()},e=function(f,d){var a,e,g=(a=b,"link"===(e=d.name)?a.link:"anchor"===e?a.anchor:v.none()).getOr([]);return n(c.text,d.name,g,f)};return{onChange:function(b,f){var a=f.name;return"url"===a?d(b()):y(["anchor","link"],a)?e(b(),f):(("text"===a||"title"===a)&&(c[a]=b()[a]),v.none())}}},getDelta:n},av=tinymce.util.Tools.resolve("tinymce.util.Delay"),aw=tinymce.util.Tools.resolve("tinymce.util.Promise"),ax=function(a,b,c){var d=a.selection.getRng();av.setEditorTimeout(a,function(){a.windowManager.confirm(b,function(b){a.selection.setRng(d),c(b)})})},ay=function(b){var a=b.href;return a.indexOf("@")>0&& -1===a.indexOf("/")&& -1===a.indexOf("mailto:")?v.some({message:"The URL you entered seems to be an email address. Do you want to add the required mailto: prefix?",preprocess:function(b){return O(O({},b),{href:"mailto:"+a})}}):v.none()},az={preprocess:function(a,d){var e,b,c;return C([ay,(b=G(a),c=a.getParam("link_default_protocol","http","string"),function(d){var a=d.href;return 1===b&&!Z(a)||0===b&&/^\s*www(\.|\d\.)/i.test(a)?v.some({message:"The URL you entered seems to be an external link. Do you want to add the required "+c+":// prefix?",preprocess:function(b){return O(O({},b),{href:c+"://"+a})}}):v.none()})],function(a){return a(d)}).fold(function(){return aw.resolve(d)},function(b){return new aw(function(c){ax(a,b.message,function(a){c(a?b.preprocess(d):d)})})})}},aA={getAnchors:function(b){var a=function(a,b){return B(z(a,b))}(b.dom.select("a:not([href]):not(.toc)"),function(b){var a=b.name||b.id;return a?[{text:a,value:"#"+a}]:[]});return a.length>0?v.some([{text:"None",value:""}].concat(a)):v.none()}},aB={getClasses:function(b){var c,a=b.getParam("link_class_list",[],"array");return a.length>0?N.sanitize(a):v.none()}},aC=tinymce.util.Tools.resolve("tinymce.util.XHR"),aD=function(a){try{return v.some(JSON.parse(a))}catch(b){return v.none()}},aE={getLinks:function(a){var b,c=function(b){return a.convertURL(b.value||b.url,"href")},d=a.getParam("link_list");return new aw(function(a){q(d)?aC.send({url:d,success:function(b){return a(aD(b))},error:function(_){return a(v.none())}}):t(d)?d(function(b){return a(v.some(b))}):a(v.from(d))}).then(function(a){return a.bind(N.sanitizeWith(c)).map(function(a){return a.length>0?[{text:"None",value:""}].concat(a):a})})}},aF={getRels:function(a,c){var b=J(a);if(b.length>0){var f=D(c,"_blank"),d=!1===K(a),e=function(a){return aa(N.getValue(a),f)};return(d?N.sanitizeWith(e):N.sanitize)(b)}return v.none()}},aG=[{text:"Current window",value:""},{text:"New window",value:"_blank"}],aH={getTargets:function(b){var a=I(b);return r(a)?N.sanitize(a).orThunk(function(){return v.some(aG)}):!1===a?v.none():v.some(aG)}},aI=function(b,c,d){var a=b.getAttrib(c,d);return null!==a&&a.length>0?v.some(a):v.none()},aJ=function(c,a){var b=c.dom,d=ae(c)?v.some(ac(c.selection,a)):v.none(),e=a?v.some(b.getAttrib(a,"href")):v.none(),f=a?v.from(b.getAttrib(a,"target")):v.none(),g=aI(b,a,"rel"),h=aI(b,a,"class"),i=aI(b,a,"title");return{url:e,text:d,title:i,target:f,rel:g,linkClass:h}},aK={collect:function(a,b){return aE.getLinks(a).then(function(d){var e,c=aJ(a,b);return{anchor:c,catalogs:{targets:aH.getTargets(a),rels:aF.getRels(a,c.target),classes:aB.getClasses(a),anchor:aA.getAnchors(a),link:d},optNode:v.from(b),flags:{titleEnabled:a.getParam("link_title",!0,"boolean")}}})}},aL=function(a){var b=ab(a);return aK.collect(a,b)},aM=function(c,d){var a=c.anchor,b=a.url.getOr("");return{url:{value:b,meta:{original:{value:b}}},text:a.text.getOr(""),title:a.title.getOr(""),anchor:b,link:b,rel:a.rel.getOr(""),target:a.target.or(d).getOr(""),linkClass:a.linkClass.getOr("")}},aN=function(b,d,e){var f=b.anchor.text.map(function(){return{name:"text",type:"input",label:"Text to display"}}).toArray(),g=b.flags.titleEnabled?[{name:"title",type:"input",label:"Title"}]:[],h=v.from(H(e)),c=aM(b,h),a=b.catalogs,j=au.init(c,a),i={type:"panel",items:B([[{name:"url",type:"urlinput",filetype:"image",label:"URL"}],f,g,E([a.anchor.map(N.createUi("anchor","Anchors")),a.rels.map(N.createUi("rel","Rel")),a.targets.map(N.createUi("target","Open link in...")),a.link.map(N.createUi("link","Link list")),a.classes.map(N.createUi("linkClass","Class"))])])};return{title:"Insert/Edit Link",size:"normal",body:i,buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:c,onChange:function(a,b){var c=b.name;j.onChange(a.getData,{name:c}).each(function(b){a.setData(b)})},onSubmit:d}},aO=function(a){aL(a).then(function(b){var c,d,e=(c=a,d=b,function(e){var a=e.getData();if(!a.url.value){ap(c),e.close();return}var b=function(b){return v.from(a[b]).filter(function(a){return!D(d.anchor[b],a)})},f={href:a.url.value,text:b("text"),target:b("target"),rel:b("rel"),class:b("linkClass"),title:b("title")},g={href:a.url.value,attach:void 0!==a.url.meta&&a.url.meta.attach?a.url.meta.attach:j};az.preprocess(c,f).then(function(a){ao(c,g,a)}),e.close()});return aN(b,e,a)}).then(function(b){a.windowManager.open(b)})},aP=function(a,b){document.body.appendChild(a),a.dispatchEvent(b),document.body.removeChild(a)},aQ=function(c){var a=document.createElement("a");a.target="_blank",a.href=c,a.rel="noreferrer noopener";var b=document.createEvent("MouseEvents");b.initMouseEvent("click",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),aP(a,b)},aR=function(a,b){return a.dom.getParent(b,"a[href]")},aS=function(a){return aR(a,a.selection.getStart())},aT=function(b,a){if(a){var c=$(a);if(/^#/.test(c)){var d=b.$(c);d.length&&b.selection.scrollIntoView(d[0],!0)}else aQ(a.href)}},aU=function(a){return function(){aO(a)}},aV=function(a){return function(){aT(a,aS(a))}},aW=function(a){a.on("click",function(b){var c=aR(a,b.target);c&&o.metaKeyPressed(b)&&(b.preventDefault(),aT(a,c))}),a.on("keydown",function(c){var b,d=aS(a);d&&13===c.keyCode&& !0===(b=c).altKey&& !1===b.shiftKey&& !1===b.ctrlKey&& !1===b.metaKey&&(c.preventDefault(),aT(a,d))})},aX=function(a,b){return a.on("NodeChange",b),function(){return a.off("NodeChange",b)}},aY=function(a){return function(c){var b=function(){return c.setActive(!a.mode.isReadOnly()&&null!==ab(a,a.selection.getNode()))};return b(),aX(a,b)}},aZ=function(a){return function(c){var b=function(){return c.setDisabled(null===ab(a,a.selection.getNode()))};return b(),aX(a,b)}},a$=function(a){return function(b){var c=function(b){var c;return ad(b)||Y(a.selection.getRng(),X).length>0},d=a.dom.getParents(a.selection.getStart());return b.setDisabled(!c(d)),aX(a,function(a){return b.setDisabled(!c(a.parents))})}},a_=function(a){a.addCommand("mceLink",function(){var b;a.getParam("link_quicklink",!1,"boolean")?a.fire("contexttoolbar-show",{toolbarKey:"quicklink"}):aU(a)()})},a0=function(a){a.addShortcut("Meta+K","",function(){a.execCommand("mceLink")})},a1=function(a){a.ui.registry.addToggleButton("link",{icon:"link",tooltip:"Insert/edit link",onAction:aU(a),onSetup:aY(a)}),a.ui.registry.addButton("openlink",{icon:"new-tab",tooltip:"Open link",onAction:aV(a),onSetup:aZ(a)}),a.ui.registry.addButton("unlink",{icon:"unlink",tooltip:"Remove link",onAction:function(){return ap(a)},onSetup:a$(a)})},a2=function(a){a.ui.registry.addMenuItem("openlink",{text:"Open link",icon:"new-tab",onAction:aV(a),onSetup:aZ(a)}),a.ui.registry.addMenuItem("link",{icon:"link",text:"Link...",shortcut:"Meta+K",onAction:aU(a)}),a.ui.registry.addMenuItem("unlink",{icon:"unlink",text:"Remove link",onAction:function(){return ap(a)},onSetup:a$(a)})},a3=function(a){a.ui.registry.addContextMenu("link",{update:function(b){return ad(a.dom.getParents(b,"a"))?"link unlink openlink":"link"}})},a4=function(a){var c=function(a){a.selection.collapse(!1)},b=function(b){var c=a.selection.getNode();return b.setDisabled(!ab(a,c)),j},d=function(d){var b=ab(a),e=ae(a);if(b||!e)return v.none();var c=ac(a.selection,b);return v.some(c.length>0?c:d)};a.ui.registry.addContextForm("quicklink",{launch:{type:"contextformtogglebutton",icon:"link",tooltip:"Link",onSetup:aY(a)},label:"Link",predicate:function(b){var c;return!!ab(a,b)&&a.getParam("link_context_toolbar",!1,"boolean")},initValue:function(){var b=ab(a);return b?$(b):""},commands:[{type:"contextformtogglebutton",icon:"link",tooltip:"Link",primary:!0,onSetup:function(b){var c=a.selection.getNode();return b.setActive(!!ab(a,c)),aY(a)(b)},onAction:function(e){var b=e.getValue(),f=d(b);ao(a,{href:b,attach:j},{href:b,text:f,title:v.none(),rel:v.none(),target:v.none(),class:v.none()}),c(a),e.hide()}},{type:"contextformbutton",icon:"unlink",tooltip:"Remove link",onSetup:b,onAction:function(b){ap(a),b.hide()}},{type:"contextformbutton",icon:"new-tab",tooltip:"Open link",onSetup:b,onAction:function(b){aV(a)(),b.hide()}}]})};i.add("link",function(a){a1(a),a2(a),a3(a),a4(a),aW(a),a_(a),a0(a)})}()